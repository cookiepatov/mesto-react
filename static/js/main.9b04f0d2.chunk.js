(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{14:function(e,t,n){},16:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),o=n(6),r=n.n(o),i=(n(14),n(9)),s=n(2),u=n(7),p=n(8),l=(document.querySelector(".popup__form_type_edit-profile-info"),document.querySelector(".popup__form_type_add-place"),document.querySelector(".popup__form_type_change-avatar"),document.querySelector(".profile__edit-button"),document.querySelector(".profile__add-button"),document.querySelector(".profile__avatar-button"),new(function(){function e(t){Object(u.a)(this,e),this._baseUrl=t.baseUrl,this._token=t.headers.authorization,this._contentType=t.headers["Content-Type"]}return Object(p.a)(e,[{key:"_resultHandler",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}},{key:"getInitialCards",value:function(){var e=this;return fetch(this._baseUrl+"/cards",{headers:{authorization:this._token}}).then((function(t){return e._resultHandler(t)}))}},{key:"getUserInfo",value:function(){var e=this;return fetch(this._baseUrl+"/users/me",{headers:{authorization:this._token}}).then((function(t){return e._resultHandler(t)}))}},{key:"setUserInfo",value:function(e,t){var n=this;return fetch(this._baseUrl+"/users/me",{method:"PATCH",headers:{authorization:this._token,"Content-Type":this._contentType},body:JSON.stringify({name:e,about:t})}).then((function(e){return n._resultHandler(e)}))}},{key:"setUserAvatar",value:function(e){var t=this;return fetch(this._baseUrl+"/users/me/avatar",{method:"PATCH",headers:{authorization:this._token,"Content-Type":this._contentType},body:JSON.stringify({avatar:e})}).then((function(e){return t._resultHandler(e)}))}},{key:"addNewCard",value:function(e,t){var n=this;return fetch(this._baseUrl+"/cards",{method:"POST",headers:{authorization:this._token,"Content-Type":this._contentType},body:JSON.stringify({name:e,link:t})}).then((function(e){return n._resultHandler(e)}))}},{key:"deleteCard",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/"+e,{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return t._resultHandler(e)}))}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.likeCard(e):this.dislikeCard(e)}},{key:"likeCard",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/likes/"+e,{method:"PUT",headers:{authorization:this._token}}).then((function(e){return t._resultHandler(e)}))}},{key:"dislikeCard",value:function(e){var t=this;return fetch(this._baseUrl+"/cards/likes/"+e,{method:"DELETE",headers:{authorization:this._token}}).then((function(e){return t._resultHandler(e)}))}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-22",headers:{authorization:"175f949a-57a4-4e41-845e-76eb0a4e61c1","Content-Type":"application/json"}})),b=Object(a.createContext)({}),d=n.p+"static/media/logo.bbe2a6ea.svg",_=n(0);var j=function(){return Object(_.jsx)("header",{className:"header",children:Object(_.jsx)("img",{src:d,className:"logo",alt:"Mesto Russia"})})};var O=function(e){var t=e.card,n=e.onCardClick,c=e.onDeleteClick,o=e.onCardLike,r=Object(a.useState)(!1),i=Object(s.a)(r,2),u=i[0],p=i[1],l=Object(a.useContext)(b)._id,d=t.likes,j=t.owner,O=t.name,f=t.link,h=j._id;Object(a.useEffect)((function(){p(!1)}),[d]);var m=l===h,v=d.some((function(e){return e._id===l})),C=m?"element__delete-button":"element__delete-button element__delete-button_hidden",x=u?"element__like-button_loading":"",y="element__like-button ".concat(v?"element__like-button element__like-button_active":""," ").concat(x);return Object(_.jsxs)("figure",{className:"element",children:[Object(_.jsx)("button",{className:"element__picture-button",style:{backgroundImage:"url(".concat(f,")")},onClick:function(){n(t)}}),Object(_.jsx)("button",{type:"button",className:C,onClick:function(){c(t)}}),Object(_.jsxs)("figcaption",{className:"element__caption",children:[Object(_.jsx)("h2",{className:"element__text",children:O}),Object(_.jsxs)("div",{className:"element__like-container",children:[Object(_.jsx)("button",{type:"button",className:y,onClick:function(){o(t),p(!0)}}),Object(_.jsx)("p",{className:"element__like-counter",children:d.length})]})]})]})};var f=function(e){var t=e.onEditProfile,n=e.onAddPlace,c=e.onEditAvatar,o=e.onCardClick,r=e.cards,i=e.onCardLike,s=e.onCardDelete,u=Object(a.useContext)(b),p=u.name,l=u.about,d=u.avatar;return Object(_.jsxs)("main",{className:"content",children:[Object(_.jsxs)("section",{className:"profile",children:[Object(_.jsx)("button",{className:"profile__avatar-button",onClick:c,style:{backgroundImage:"url(".concat(d,")")}}),Object(_.jsxs)("div",{className:"profile__info",children:[Object(_.jsx)("h1",{className:"profile__name",children:p}),Object(_.jsx)("button",{type:"button",className:"profile__edit-button",onClick:t}),Object(_.jsx)("p",{className:"profile__description",children:l})]}),Object(_.jsx)("button",{type:"button",className:"profile__add-button",onClick:n})]}),Object(_.jsx)("section",{className:"elements",children:r.map((function(e){return Object(_.jsx)(O,{card:e,onCardClick:o,onDeleteClick:s,onCardLike:i},e._id)}))})]})};var h=function(){var e=(new Date).getFullYear();return Object(_.jsx)("footer",{className:"footer",children:Object(_.jsxs)("p",{className:"copyright",children:["\xa9 ",e," Mesto Russia"]})})};var m=function(e){var t=e.name,n=e.title,a=e.children,c=e.isOpen,o=e.onClose,r=e.onSubmit,i=c?"popup popup_type_".concat(t," popup_opened"):"popup popup_type_".concat(t);return Object(_.jsx)("section",{className:i,children:Object(_.jsxs)("div",{className:"popup__container",children:[Object(_.jsx)("button",{type:"button",className:"popup__close-button",onClick:o}),Object(_.jsx)("h2",{className:"popup__title",children:n}),Object(_.jsx)("form",{className:"popup__form",name:t,onSubmit:r,children:a})]})})};var v=function(e){var t=e.isOpen,n=e.onClose,c=e.onUpdateUser,o=e.isLoading,r=Object(a.useContext)(b),i=Object(a.useState)("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),u=Object(s.a)(i,2),p=u[0],l=u[1],d=Object(a.useState)(""),j=Object(s.a)(d,2),O=j[0],f=j[1],h=Object(a.useState)(!0),v=Object(s.a)(h,2),C=v[0],x=v[1],y=Object(a.useState)("popup__input"),g=Object(s.a)(y,2),k=g[0],S=g[1],N=Object(a.useState)(""),E=Object(s.a)(N,2),L=E[0],U=E[1],I=Object(a.useState)("popup__error"),T=Object(s.a)(I,2),w=T[0],P=T[1],D=Object(a.useState)(""),A=Object(s.a)(D,2),q=A[0],H=A[1],z=Object(a.useState)(!0),M=Object(s.a)(z,2),R=M[0],F=M[1],J=Object(a.useState)("popup__input"),B=Object(s.a)(J,2),V=B[0],Y=B[1],G=Object(a.useState)(""),K=Object(s.a)(G,2),Q=K[0],W=K[1],X=Object(a.useState)("popup__error"),Z=Object(s.a)(X,2),$=Z[0],ee=Z[1],te=Object(a.useState)(!0),ne=Object(s.a)(te,2),ae=ne[0],ce=ne[1],oe=Object(a.useRef)();return Object(a.useEffect)((function(){if(o){var e=[".","..","..."],t=0;oe.current=setInterval((function(){l("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435".concat(e[t])),t=2===t?0:t+1}),500)}else clearInterval(oe.current),l("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}),[o]),Object(a.useEffect)((function(){f(r.name||""),H(r.about||""),x(!0),S("popup__input"),U(""),P("popup__error"),F(!0),Y("popup__input"),W(""),ee("popup__error")}),[r,t]),Object(a.useEffect)((function(){ce(C&&R)}),[C,R]),Object(_.jsxs)(m,{name:"profile",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({name:O,about:q})},children:[Object(_.jsx)("input",{id:"profile-name-input",name:"name",required:!0,minLength:"2",maxLength:"40",className:k,placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",value:O,onChange:function(e){var t,n,a=e.target,c=a.value,o=a.validity,r=a.validationMessage;f(c),t=o.valid,n=r,x(t),t?(S("popup__input"),U(""),P("popup__error")):(S("popup__input popup__input_type_error"),U(n),P("popup__error popup__error_visible"))}}),Object(_.jsx)("span",{className:w,children:L}),Object(_.jsx)("input",{id:"profile-description-input",name:"description",required:!0,minLength:"2",maxLength:"200",className:V,placeholder:"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435",value:q,onChange:function(e){var t,n,a=e.target,c=a.value,o=a.validity,r=a.validationMessage;H(c),t=o.valid,n=r,F(t),t?(Y("popup__input"),W(""),ee("popup__error")):(Y("popup__input popup__input_type_error"),W(n),ee("popup__error popup__error_visible"))}}),Object(_.jsx)("span",{className:$,children:Q}),Object(_.jsx)("button",{type:"submit",className:"popup__button",disabled:!ae,children:p})]})};var C=function(e){var t=e.isOpen,n=e.onClose,a=e.selectedCard,c=a?a.link:"#",o=a?a.name:"",r=t?"popup popup_opened popup_type_full-view":"popup popup_type_full-view";return Object(_.jsx)("section",{className:r,children:Object(_.jsx)("figure",{className:"popup__picture-container",children:Object(_.jsxs)("div",{className:"popup__picture-elements",children:[Object(_.jsx)("button",{type:"button",className:"popup__close-button",onClick:n}),Object(_.jsx)("img",{className:"popup__full-picture",alt:"\u041f\u043e\u043b\u043d\u043e\u044d\u043a\u0440\u0430\u043d\u043d\u044b\u0439 \u043f\u0440\u043e\u0441\u043c\u043e\u0442\u0440",src:c}),Object(_.jsx)("h2",{className:"popup__picture-title",children:o})]})})})};var x=function(e){var t=e.isOpen,n=e.onClose,c=e.onUpdateAvatar,o=e.isLoading,r=Object(a.useContext)(b),i=Object(a.useRef)(""),u=Object(a.useRef)(),p=Object(a.useState)(!0),l=Object(s.a)(p,2),d=l[0],j=l[1],O=Object(a.useState)(!0),f=Object(s.a)(O,2),h=f[0],v=f[1],C=Object(a.useState)("popup__input"),x=Object(s.a)(C,2),y=x[0],g=x[1],k=Object(a.useState)(""),S=Object(s.a)(k,2),N=S[0],E=S[1],L=Object(a.useState)("popup__error"),U=Object(s.a)(L,2),I=U[0],T=U[1],w=Object(a.useState)("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),P=Object(s.a)(w,2),D=P[0],A=P[1];return Object(a.useEffect)((function(){j(h)}),[h]),Object(a.useEffect)((function(){v(!0),g("popup__input"),E(""),T("popup__error")}),[t]),Object(a.useEffect)((function(){if(o){var e=[".","..","..."],t=0;u.current=setInterval((function(){A("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435".concat(e[t])),t=2===t?0:t+1}),500)}else clearInterval(u.current),A("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}),[o]),Object(a.useEffect)((function(){i.current=r.avatar}),[r]),Object(_.jsxs)(m,{name:"avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c(i.current)},children:[Object(_.jsx)("input",{id:"avatar-link-input",name:"data",required:!0,type:"url",className:y,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0430\u0432\u0430\u0442\u0430\u0440",defaultValue:i.current,onChange:function(e){var t,n,a=e.target,c=a.value,o=a.validity,r=a.validationMessage;i.current=c,t=o.valid,n=r,v(t),t?(g("popup__input"),E(""),T("popup__error")):(g("popup__input popup__input_type_error"),E(n),T("popup__error popup__error_visible"))}}),Object(_.jsx)("span",{className:I,children:N}),Object(_.jsx)("button",{type:"submit",className:"popup__button",disabled:!d,children:D})]})};var y=function(e){var t=e.isOpen,n=e.onClose,c=e.onAddPlace,o=e.isLoading,r=Object(a.useState)("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"),i=Object(s.a)(r,2),u=i[0],p=i[1],l=Object(a.useState)(""),b=Object(s.a)(l,2),d=b[0],j=b[1],O=Object(a.useState)(!1),f=Object(s.a)(O,2),h=f[0],v=f[1],C=Object(a.useState)("popup__input"),x=Object(s.a)(C,2),y=x[0],g=x[1],k=Object(a.useState)(""),S=Object(s.a)(k,2),N=S[0],E=S[1],L=Object(a.useState)("popup__error"),U=Object(s.a)(L,2),I=U[0],T=U[1],w=Object(a.useState)(""),P=Object(s.a)(w,2),D=P[0],A=P[1],q=Object(a.useState)(!1),H=Object(s.a)(q,2),z=H[0],M=H[1],R=Object(a.useState)("popup__input"),F=Object(s.a)(R,2),J=F[0],B=F[1],V=Object(a.useState)(""),Y=Object(s.a)(V,2),G=Y[0],K=Y[1],Q=Object(a.useState)("popup__error"),W=Object(s.a)(Q,2),X=W[0],Z=W[1],$=Object(a.useState)(!1),ee=Object(s.a)($,2),te=ee[0],ne=ee[1],ae=Object(a.useRef)();return Object(a.useEffect)((function(){if(o){var e=[".","..","..."],t=0;ae.current=setInterval((function(){p("\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435".concat(e[t])),t=2===t?0:t+1}),500)}else clearInterval(ae.current),p("\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c")}),[o]),Object(a.useEffect)((function(){j(""),A(""),v(!1),g("popup__input"),E(""),T("popup__error"),M(!1),B("popup__input"),K(""),Z("popup__error")}),[t]),Object(a.useEffect)((function(){ne(h&&z)}),[h,z]),Object(_.jsxs)(m,{name:"card",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({name:d,link:D})},children:[Object(_.jsx)("input",{id:"place-name-input",name:"name",required:!0,minLength:"2",maxLength:"30",className:y,placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",onChange:function(e){var t,n,a=e.target,c=a.value,o=a.validity,r=a.validationMessage;j(c),t=o.valid,n=r,v(t),t?(g("popup__input"),E(""),T("popup__error")):(g("popup__input popup__input_type_error"),E(n),T("popup__error popup__error_visible"))},value:d}),Object(_.jsx)("span",{className:I,children:N}),Object(_.jsx)("input",{id:"place-link-input",name:"data",required:!0,type:"url",className:J,placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",onChange:function(e){var t,n,a=e.target,c=a.value,o=a.validity,r=a.validationMessage;A(c),t=o.valid,n=r,M(t),t?(B("popup__input"),K(""),Z("popup__error")):(B("popup__input popup__input_type_error"),K(n),Z("popup__error popup__error_visible"))},value:D}),Object(_.jsx)("span",{className:X,children:G}),Object(_.jsx)("button",{type:"submit",className:"popup__button",disabled:!te,children:u})]})};var g=function(e){var t=e.isOpen,n=e.onClose,c=e.selectedCard,o=e.onDeleteCard,r=e.isLoading,i=Object(a.useState)("\u0414\u0430"),u=Object(s.a)(i,2),p=u[0],l=u[1],b=Object(a.useRef)();return Object(a.useEffect)((function(){if(r){var e=[".","..","..."],t=0;b.current=setInterval((function(){l("\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435".concat(e[t])),t=2===t?0:t+1}),500)}else clearInterval(b.current),l("\u0414\u0430")}),[r]),Object(_.jsx)(m,{name:"remove-card",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),o(c)},children:Object(_.jsx)("button",{type:"submit",className:"popup__button",children:p})})};var k=function(){var e=Object(a.useState)(!1),t=Object(s.a)(e,2),n=t[0],c=t[1],o=Object(a.useState)(!1),r=Object(s.a)(o,2),u=r[0],p=r[1],d=Object(a.useState)(!1),O=Object(s.a)(d,2),m=O[0],k=O[1],S=Object(a.useState)(!1),N=Object(s.a)(S,2),E=N[0],L=N[1],U=Object(a.useState)(!1),I=Object(s.a)(U,2),T=I[0],w=I[1],P=Object(a.useState)({}),D=Object(s.a)(P,2),A=D[0],q=D[1],H=Object(a.useState)({}),z=Object(s.a)(H,2),M=z[0],R=z[1],F=Object(a.useState)([]),J=Object(s.a)(F,2),B=J[0],V=J[1],Y=Object(a.useState)({}),G=Object(s.a)(Y,2),K=G[0],Q=G[1],W=Object(a.useState)(!1),X=Object(s.a)(W,2),Z=X[0],$=X[1];function ee(){document.removeEventListener("keydown",ne),document.removeEventListener("pointerdown",ae),k(!1),c(!1),p(!1),L(!1),w(!1),q({}),Q({})}function te(){document.addEventListener("keydown",ne),document.addEventListener("pointerdown",ae)}function ne(e){"Escape"===e.key&&ee()}function ae(e){e.target.classList.contains("popup")&&ee()}return Object(a.useEffect)((function(){Promise.all([l.getUserInfo(),l.getInitialCards()]).then((function(e){var t=Object(s.a)(e,2),n=t[0],a=t[1];R(n),V(a)})).catch(console.log)}),[]),Object(_.jsx)(b.Provider,{value:M,children:Object(_.jsxs)("div",{className:"page",children:[Object(_.jsx)(j,{}),Object(_.jsx)(f,{onEditProfile:function(){te(),c(!0)},onAddPlace:function(){te(),p(!0)},onEditAvatar:function(){document.addEventListener("keydown",ne),document.addEventListener("pointerdown",ae),k(!0)},onCardClick:function(e){te(),w(!0),q(e)},cards:B,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===M._id}));l.changeLikeCardStatus(e._id,!t).then((function(t){V((function(n){return n.map((function(n){return n._id===e._id?t:n}))})),ee()})).catch(console.log)},onCardDelete:function(e){te(),L(!0),Q(e)}}),Object(_.jsx)(h,{}),Object(_.jsx)(v,{onUpdateUser:function(e){var t=e.name,n=e.about;$(!0),l.setUserInfo(t,n).then((function(e){R(e),ee()})).catch(console.log).finally((function(){$(!1)}))},onClose:ee,isOpen:n,isLoading:Z}),Object(_.jsx)(y,{onAddPlace:function(e){var t=e.name,n=e.link;$(!0),l.addNewCard(t,n).then((function(e){V((function(t){return[e].concat(Object(i.a)(t))})),ee()})).catch(console.log).finally((function(){$(!1)}))},onClose:ee,isOpen:u,isLoading:Z}),Object(_.jsx)(x,{onUpdateAvatar:function(e){$(!0),l.setUserAvatar(e).then((function(e){R(e),ee()})).catch(console.log).finally((function(){$(!1)}))},onClose:ee,isOpen:m,isLoading:Z}),Object(_.jsx)(g,{onDeleteCard:function(e){$(!0),l.deleteCard(e._id).then((function(){V((function(t){return t.filter((function(t){return t._id!==e._id}))})),ee()})).catch(console.log).finally((function(){$(!1)}))},onClose:ee,isOpen:E,selectedCard:K,isLoading:Z}),Object(_.jsx)(C,{isOpen:T,onClose:ee,selectedCard:A})]})})},S=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,17)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,r=t.getTTFB;n(e),a(e),c(e),o(e),r(e)}))};r.a.render(Object(_.jsx)(c.a.StrictMode,{children:Object(_.jsx)(k,{})}),document.getElementById("root")),S()}},[[16,1,2]]]);
//# sourceMappingURL=main.9b04f0d2.chunk.js.map